# Виправлення помилки "Помилка створення користувача"

## Проблема

Після спроби входу з'являється помилка "Помилка створення користувача. Спробуйте інший нікнейм."

## Основна причина

**Email Confirmation увімкнено в Supabase Cloud** - це найчастіша причина проблеми.

## Рішення

### Крок 1: Вимкнути Email Confirmation (ОБОВ'ЯЗКОВО)

1. Відкрийте [Supabase Dashboard](https://app.supabase.com)
2. Виберіть ваш проект
3. Перейдіть в **Authentication** → **Settings**
4. Знайдіть секцію **Email Auth**
5. **ВИМКНІТЬ** "Enable email confirmations"
6. Збережіть зміни
7. Зачекайте 10-30 секунд для застосування змін

### Крок 2: Перевірка логів

Після спроби входу перевірте логи в Vercel Dashboard. Ви маєте побачити:

```
SignUp result: {
  hasUser: true/false,
  hasSession: true/false,
  error: "...",
  email: "..."
}
```

### Крок 3: Якщо проблема залишається

#### Варіант A: Перевірте формат email

Supabase може не приймати певні формати email. Поточний формат: `guest+hash@supabase.co` або `guest+hash@example.com`

#### Варіант B: Використати Service Role Key

Якщо email confirmation не можна вимкнути, можна створити користувача через service_role key:

1. Додайте `SUPABASE_SERVICE_ROLE_KEY` в environment variables
2. Використайте service_role key для створення користувача напряму в БД

#### Варіант C: Перевірте налаштування проекту

1. Перевірте чи проект активний
2. Перевірте чи не перевищено ліміти (безкоштовний tier має обмеження)
3. Перевірте чи правильно налаштовані environment variables

## Детальна діагностика

### Перевірте логи після спроби входу:

1. Відкрийте Vercel Dashboard → ваш проект → Logs
2. Знайдіть записи з `SignUp result:` та `Retry signIn result:`
3. Перевірте що показує `hasUser` та `hasSession`

### Можливі значення:

- `hasUser: false` - користувач не створений (проблема з email confirmation або валідацією)
- `hasUser: true, hasSession: false` - користувач створений, але сесія не встановлена (email confirmation увімкнено)
- `hasUser: true, hasSession: true` - все працює правильно

## Швидке виправлення

1. ✅ **ВИМКНІТЬ email confirmation** в Supabase Dashboard
2. ✅ Зачекайте 30 секунд
3. ✅ Спробуйте увійти знову
4. ✅ Перевірте логи якщо проблема залишається

## Важливо

- Email confirmation **ОБОВ'ЯЗКОВО** має бути вимкнено для guest-авторизації
- Після вимкнення може знадобитися час для застосування змін
- Перевірте логи для детальної інформації про помилку

